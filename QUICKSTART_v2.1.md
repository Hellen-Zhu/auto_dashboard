# 快速入门 - 可视化编辑器 v2.1

## 🚀 5分钟上手指南

### 访问地址
**新版可视化编辑器**: http://localhost:3000/index_v2.html

---

## 📝 创建第一个测试用例

### 场景示例
创建一个测试用例：验证获取K线数据接口

---

### Step 1: 填写基本信息 (30秒)

点击 **[+ 创建用例]** 按钮，填写:

```
用例名称: 验证获取BTC_USD的1小时K线数据
Service: exchange_svc
Module: market
Component: candlestick
Tags: p0, smoke, api
Environments: uat
描述: 验证K线数据接口能正确返回BTC_USD的1小时K线数据
```

---

### Step 2: 配置测试步骤 (1分钟)

切换到 **[测试步骤]** 标签页:

1. 默认已有一个步骤，编辑它:
   ```
   HTTP Method: GET
   URL Path: /exchange/v1/public/get-candlestick
   描述: 获取K线数据
   ```

2. 编辑 **Headers**:
   ```json
   {
     "Content-Type": "application/json"
   }
   ```

3. 编辑 **Query Params**:
   ```json
   {
     "instrument_name": "{{@instrument}}",
     "timeframe": "{{@timeframe}}",
     "count": "{{@count}}"
   }
   ```

💡 **提示**: 使用 `{{@变量名}}` 引用变量，稍后在变量配置中定义

---

### Step 3: 配置变量 (1分钟)

切换到 **[变量配置]** 标签页:

1. 点击 **[+ 添加变量]**，输入变量名: `instrument`
2. 在值栏填写: `BTC_USD`

3. 重复添加:
   - 变量名: `timeframe`，值: `1h`
   - 变量名: `count`，值: `100`

最终效果:
```
[变量名]     [变量值]     [×]
instrument   BTC_USD     [×]
timeframe    1h          [×]
count        100         [×]
```

---

### Step 4: 配置验证规则 (1分钟)

切换到 **[验证规则]** 标签页:

1. 点击 **[+ 添加验证]**
2. 输入步骤编号: `1`
3. 填写验证条件:
   ```
   期望状态码: 200

   必须存在的字段:
   $.result, $.result.data, $.result.instrument_name

   不应存在的字段:
   $.error
   ```

---

### Step 5: 预览与保存 (30秒)

1. 切换到 **[JSON预览]** 标签页
2. 查看自动生成的 test_config:
   ```json
   {
     "steps": [
       {
         "order": 1,
         "method": "GET",
         "path": "/exchange/v1/public/get-candlestick",
         "description": "获取K线数据",
         "request": {
           "headers": {"Content-Type": "application/json"},
           "params": {
             "instrument_name": "{{@instrument}}",
             "timeframe": "{{@timeframe}}",
             "count": "{{@count}}"
           },
           "body": null
         }
       }
     ],
     "variables": {
       "instrument": "BTC_USD",
       "timeframe": "1h",
       "count": "100"
     },
     "validations": {
       "1": {
         "expectedStatusCode": 200,
         "notNull": [
           "$.result",
           "$.result.data",
           "$.result.instrument_name"
         ],
         "notExist": ["$.error"]
       }
     }
   }
   ```

3. 确认无误后，点击 **[保存]** 按钮

4. 成功！用例已创建 ✅

---

## 🔧 编辑现有用例

### 快速编辑流程

1. 在列表中找到要编辑的用例
2. 点击 **[编辑]** 按钮
3. 系统自动加载并解析数据到各个标签页
4. 修改任意字段
5. 点击 **[保存]** 更新

### 常见编辑场景

#### 场景1: 修改请求参数
```
1. 切换到 [测试步骤] 标签
2. 找到对应步骤的 Params 字段
3. 直接修改JSON
4. 保存
```

#### 场景2: 添加新变量
```
1. 切换到 [变量配置] 标签
2. 点击 [+ 添加变量]
3. 输入变量名和值
4. 在步骤中使用 {{@新变量名}}
5. 保存
```

#### 场景3: 调整验证规则
```
1. 切换到 [验证规则] 标签
2. 修改期望状态码或字段验证
3. 保存
```

---

## 💡 高级技巧

### 1. 多步骤测试

**场景**: 需要先登录，再调用API

**步骤**:
1. 切换到 [测试步骤]
2. 点击 **[+ 添加步骤]**
3. 配置 Step 1: POST /auth/login
4. 配置 Step 2: GET /api/data
5. 在 Step 2 中使用 Step 1 的输出

### 2. 使用变量引用

**在任何地方使用**:
```json
{
  "instrument_name": "{{@instrument}}",
  "user_id": "{{@userId}}",
  "api_key": "{{@apiKey}}"
}
```

**变量会在运行时自动替换**

### 3. 复杂验证

**场景**: 验证响应体的具体字段值

```
期望响应体:
{
  "code": 0,
  "result": {
    "instrument_name": "BTC_USD",
    "interval": "1h"
  }
}

必须存在的字段:
$.result.data, $.result.data[0], $.result.data[0].open

不应存在的字段:
$.error, $.exception, $.result.error_code
```

### 4. 环境隔离

**场景**: 某些用例只在 UAT 环境运行

```
Environments: uat

(留空表示所有环境都运行)
```

---

## 🎯 界面导航

### 主界面布局
```
┌─────────────────────────────────────────┐
│ Crypto Test Admin v2.0                 │ ← Header
├─────────────────────────────────────────┤
│ [Service ▼] [Module ▼] [刷新] [+ 创建] │ ← Toolbar
├─────────────────────────────────────────┤
│ ID │ 名称 │ Service │ ... │ 操作       │
│ 1  │ xxx  │ xxx     │ ... │ [编辑][删除]│ ← Table
│ 2  │ xxx  │ xxx     │ ... │ [编辑][删除]│
└─────────────────────────────────────────┘
```

### 编辑弹窗布局
```
┌────────────── 创建/编辑测试用例 ──────────────┐
│ [基本信息区域]                               │
│   用例名称、Service、Module、Tags...         │
├───────────────────────────────────────────────┤
│ [测试步骤] [变量配置] [验证规则] [JSON预览]  │ ← Tabs
├───────────────────────────────────────────────┤
│                                               │
│  Tab 内容区域 (动态切换)                     │
│                                               │
├───────────────────────────────────────────────┤
│                          [取消]    [保存]     │
└───────────────────────────────────────────────┘
```

---

## ⌨️ 快捷操作

### 键盘技巧
- **Tab 键**: 在输入框间快速切换
- **Enter**: 在单行输入框中快速提交（需自行实现）
- **Ctrl/Cmd + C**: 复制JSON预览内容

### 鼠标技巧
- **双击**: 快速聚焦输入框
- **Ctrl+点击**: 在新标签页打开（浏览器默认）

---

## 🐛 常见问题

### Q1: JSON格式错误
**问题**: 保存时提示 "JSON格式错误"

**解决**:
1. 检查 Headers/Params/Body 字段的JSON格式
2. 确保使用双引号，不要用单引号
3. 检查是否有多余的逗号
4. 使用在线JSON验证工具检查

**正确示例**:
```json
{"key": "value"}
```

**错误示例**:
```json
{key: 'value'}  ❌ 应该用双引号
{"key": "value",}  ❌ 多余的逗号
```

### Q2: 变量不生效
**问题**: 使用了 `{{@variable}}` 但没替换

**解决**:
1. 检查变量名拼写是否正确
2. 确保变量在 [变量配置] 中已定义
3. 确认使用了正确的语法: `{{@变量名}}`

### Q3: 验证规则不匹配
**问题**: 测试失败，提示验证不通过

**解决**:
1. 检查 JSONPath 语法是否正确
2. 使用 [JSON预览] 确认结构
3. 先用简单验证测试，再逐步增加复杂度

### Q4: 步骤删除后编号错乱
**答**: 这是正常的！系统会自动重新编号步骤，确保顺序正确

---

## 📊 与旧版对比

| 功能 | 旧版 (index.html) | 新版 (index_v2.html) |
|------|-------------------|---------------------|
| **编辑方式** | 纯JSON编辑 | 可视化表单 ✨ |
| **学习曲线** | 需要熟悉JSON | 直观易用 ✅ |
| **错误率** | 较高 (语法错误) | 较低 (表单验证) ✅ |
| **创建速度** | 10-15分钟 | 3-5分钟 ⚡ |
| **维护性** | 需要手动编辑JSON | 独立字段编辑 ✅ |
| **JSON预览** | 无 | 实时预览 ✅ |

---

## 🎓 学习路径

### 初学者 (第1天)
1. ✅ 阅读本快速入门
2. ✅ 创建第一个简单用例
3. ✅ 尝试编辑现有用例

### 进阶用户 (第2-3天)
1. ✅ 创建多步骤测试
2. ✅ 使用变量引用
3. ✅ 配置复杂验证规则

### 专家用户 (第4-7天)
1. ✅ 阅读完整文档 [VISUAL_EDITOR_v2.1.md](VISUAL_EDITOR_v2.1.md)
2. ✅ 探索高级功能
3. ✅ 与测试框架集成

---

## 🔗 相关资源

- **完整文档**: [VISUAL_EDITOR_v2.1.md](VISUAL_EDITOR_v2.1.md)
- **迁移指南**: [MIGRATION_v2.0.md](MIGRATION_v2.0.md)
- **API文档**: http://localhost:8000/docs
- **主README**: [README.md](README.md)

---

## 🎉 开始使用

**立即体验**: http://localhost:3000/index_v2.html

1. 打开浏览器
2. 访问上述地址
3. 点击 [+ 创建用例]
4. 跟随界面提示
5. 3分钟完成第一个用例！

**祝你使用愉快！** 🚀
